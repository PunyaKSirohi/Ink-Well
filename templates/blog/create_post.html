{% extends 'base.html' %}

{% block title %}Create New Post - InkWell{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-10">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h3 class="mb-0">‚úçÔ∏è Create New Post</h3>
                <a href="{% url 'blog:user_posts' %}" class="btn btn-outline-secondary btn-sm">
                    <i class="bi bi-arrow-left"></i> My Posts
                </a>
            </div>
            <div class="card-body">
                <form method="post">
                    {% csrf_token %}
                    
                    <div class="row">
                        <div class="col-md-8">
                            <div class="mb-3">
                                <label for="{{ form.title.id_for_label }}" class="form-label">{{ form.title.label }}</label>
                                {{ form.title }}
                                {% if form.title.errors %}
                                    <div class="text-danger small">{{ form.title.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label for="{{ form.status.id_for_label }}" class="form-label">{{ form.status.label }}</label>
                                {{ form.status }}
                                {% if form.status.errors %}
                                    <div class="text-danger small">{{ form.status.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-8">
                            <div class="mb-3">
                                <label for="{{ form.slug.id_for_label }}" class="form-label">{{ form.slug.label }}</label>
                                {{ form.slug }}
                                <div class="form-text">Leave blank to auto-generate from title</div>
                                {% if form.slug.errors %}
                                    <div class="text-danger small">{{ form.slug.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label for="{{ form.tags.id_for_label }}" class="form-label">{{ form.tags.label }}</label>
                                {{ form.tags }}
                                <div class="form-text">Separate with commas</div>
                                {% if form.tags.errors %}
                                    <div class="text-danger small">{{ form.tags.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label for="{{ form.body.id_for_label }}" class="form-label">{{ form.body.label }}</label>
                        {{ form.body }}
                        {% if form.body.errors %}
                            <div class="text-danger small">{{ form.body.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="d-flex justify-content-between">
                        <div>
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="bi bi-check-circle"></i> Create Post
                            </button>
                            <a href="{% url 'blog:user_posts' %}" class="btn btn-secondary btn-lg ms-2">
                                <i class="bi bi-x-circle"></i> Cancel
                            </a>
                        </div>
                        <div class="text-muted small align-self-end">
                            <i class="bi bi-info-circle"></i> You can always edit this post later
                        </div>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Tips Card -->
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0">üí° Writing Tips</h5>
            </div>
            <div class="card-body">
                <ul class="mb-0">
                    <li><strong>Title:</strong> Make it clear and engaging</li>
                    <li><strong>Slug:</strong> URL-friendly version of your title (auto-generated if blank)</li>
                    <li><strong>Content:</strong> Use line breaks for paragraphs</li>
                    <li><strong>Tags:</strong> Help readers find related content</li>
                    <li><strong>Status:</strong> Save as "Draft" to preview before publishing</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<script>
// Auto-generate slug from title
document.getElementById('id_title').addEventListener('input', function() {
    const title = this.value;
    const slugField = document.getElementById('id_slug');
    
    if (!slugField.value || slugField.dataset.autoGenerated) {
        const slug = title.toLowerCase()
            .replace(/[^a-z0-9\s-]/g, '')
            .replace(/\s+/g, '-')
            .replace(/-+/g, '-')
            .replace(/^-|-$/g, '');
        
        slugField.value = slug;
        slugField.dataset.autoGenerated = 'true';
    }
});

// Remove auto-generation flag when manually editing slug
document.getElementById('id_slug').addEventListener('input', function() {
    this.dataset.autoGenerated = 'false';
});
</script>
{% endblock %}
